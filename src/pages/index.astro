---
import { getCollection } from 'astro:content';
import BaseLayout from '../layouts/BaseLayout.astro';
import ProjectCard from '../components/ProjectCard.astro';
import BlogPostCard from '../components/BlogPostCard.astro';
import { SITE_TITLE, SITE_DESCRIPTION } from '../consts';

const featuredProjects = (await getCollection('projects'))
	.filter(p => p.data.featured)
	.sort((a, b) => a.data.order - b.data.order)
	.slice(0, 3);

const recentPosts = (await getCollection('blog'))
	.sort((a, b) => b.data.pubDate.valueOf() - a.data.pubDate.valueOf())
	.slice(0, 3);
---

<BaseLayout title={SITE_TITLE} description={SITE_DESCRIPTION}>
	<!-- Hero Section -->
	<section class="max-w-5xl mx-auto px-4 py-16 md:py-24">
		<div class="flex flex-col md:flex-row items-center md:items-start gap-8 md:gap-12">
			<!-- Placeholder Image -->
			<div class="w-40 h-40 md:w-52 md:h-52 rounded-2xl bg-gradient-to-br from-accent/20 to-accent-light/30 dark:from-accent/30 dark:to-accent-light/40 flex items-center justify-center shrink-0">
				<span class="text-4xl md:text-5xl font-bold text-accent dark:text-accent-light select-none">DH</span>
			</div>
			<!-- Text Content -->
			<div class="text-center md:text-left">
				<h1 class="text-4xl md:text-5xl font-bold text-gray-dark dark:text-text-dark mb-2">
					Daniel Hirt
				</h1>
				<p class="text-lg text-gray dark:text-text-dark-muted mb-4">
					Software Engineer <svg class="inline-block w-5 h-5 mx-0.5 align-middle" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><line x1="6" y1="6" x2="18" y2="18" class="stroke-accent dark:stroke-accent-light" /><line x1="18" y1="6" x2="6" y2="18" class="stroke-accent dark:stroke-accent-light" /></svg> Lifelong Learner
				</p>
				<p class="text-base text-gray dark:text-text-dark-muted leading-relaxed mb-6">
					Currently building data-intensive systems at <a href="https://appian.com/" target="_blank" rel="noopener noreferrer" class="text-accent dark:text-accent-light hover:text-accent-dark dark:hover:text-white transition-colors font-medium">Appian</a> in the Washington, DC area. 6+ years of experience specializing in databases, Java, and Go. Chess nerd, endlessly curious, and always chasing the next hard problem.
				</p>
				<div class="flex flex-col items-center md:items-start gap-2 mb-8 text-gray dark:text-text-dark-muted">
					<p>GitHub: <a href="https://github.com/danielhirt" target="_blank" rel="noopener noreferrer" class="text-accent dark:text-accent-light hover:text-accent-dark dark:hover:text-white transition-colors">@danielhirt</a></p>
					<p>Email: <button id="copy-email" type="button" class="text-accent dark:text-accent-light hover:text-accent-dark dark:hover:text-white transition-colors cursor-pointer">danielchirt16 [at] gmail (dot) com</button></p>
				</div>
				<div class="flex justify-center md:justify-start gap-4">
					<a
						href="/projects"
						class="px-6 py-3 bg-gradient-to-r from-accent to-accent-light text-white rounded-lg hover:brightness-110 transition-all font-medium"
					>
						View Projects
					</a>
					<a
						href="/blog"
						class="px-6 py-3 bg-gradient-to-r from-accent/10 to-accent-light/20 text-accent dark:from-accent/20 dark:to-accent-light/30 dark:text-accent-light rounded-lg hover:brightness-110 transition-all font-medium"
					>
						Read Blog
					</a>
				</div>
			</div>
		</div>
	</section>

	<script>
		document.getElementById('copy-email')?.addEventListener('click', async () => {
			await navigator.clipboard.writeText('danielchirt16@gmail.com');
			const btn = document.getElementById('copy-email');
			if (btn) {
				const original = btn.textContent;
				btn.textContent = 'Copied!';
				setTimeout(() => { btn.textContent = original; }, 2000);
			}
		});
	</script>

	<!-- Featured Projects -->
	{featuredProjects.length > 0 && (
		<section class="max-w-5xl mx-auto px-4 py-12">
			<div class="flex items-center justify-between mb-8">
				<h2 class="text-2xl font-bold text-gray-dark dark:text-text-dark">Featured Projects</h2>
				<a href="/projects" class="text-accent dark:text-accent-light hover:text-accent-dark dark:hover:text-white transition-colors">
					View all &rarr;
				</a>
			</div>
			<div class="grid md:grid-cols-2 lg:grid-cols-3 gap-6">
				{featuredProjects.map((project) => (
					<ProjectCard project={project} />
				))}
			</div>
		</section>
	)}

	<!-- Recent Blog Posts -->
	{recentPosts.length > 0 && (
		<section class="max-w-5xl mx-auto px-4 py-12">
			<div class="flex items-center justify-between mb-8">
				<h2 class="text-2xl font-bold text-gray-dark dark:text-text-dark">Recent Posts</h2>
				<a href="/blog" class="text-accent dark:text-accent-light hover:text-accent-dark dark:hover:text-white transition-colors">
					View all &rarr;
				</a>
			</div>
			<div class="grid md:grid-cols-2 gap-6">
				{recentPosts.map((post, index) => (
					<BlogPostCard post={post} featured={index === 0} />
				))}
			</div>
		</section>
	)}
</BaseLayout>

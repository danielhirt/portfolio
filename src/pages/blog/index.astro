---
import { getCollection } from 'astro:content';
import BaseLayout from '../../layouts/BaseLayout.astro';
import FormattedDate from '../../components/FormattedDate.astro';

const posts = (await getCollection('blog'))
	.sort((a, b) => b.data.pubDate.valueOf() - a.data.pubDate.valueOf());

const title = 'Blog';
const description = 'Thoughts on software engineering, projects, and things I am learning.';
---

<BaseLayout title={title} description={description}>
	<section class="max-w-2xl mx-auto px-4 py-12">
		<div class="tracer-box bg-bg-dark/60 backdrop-blur-md border border-gray-light/10 px-8 py-10 md:px-10 md:py-12">
			{posts.length > 0 ? (
				posts.map((post, i) => (
					<div class:list={[i > 0 && "border-t border-gray-dark/50 pt-8", i > 0 ? "mt-8" : ""]}>
						<a href={`/blog/${post.id}/`} class="font-bold text-accent-light hover:text-white transition-colors">{post.data.title}</a>
						<p class="text-xs text-text-dark-muted font-mono mt-1 mb-2">
							<FormattedDate date={post.data.pubDate} />
						</p>
						<p class="text-sm text-text-dark-muted leading-relaxed">{post.data.description}</p>
					</div>
				))
			) : (
				<p class="text-sm text-text-dark-muted">No posts yet. Check back soon!</p>
			)}
		</div>
	</section>
</BaseLayout>
